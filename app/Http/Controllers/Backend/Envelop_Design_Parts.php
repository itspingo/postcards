<?php

namespace App\Http\Controllers\Backend;
use App\Http\Controllers\Controller;
use Illuminate\Http\Request;

use App\Models\envelop_design_parts_model;


/* ******************************************************
    This file is generated by SNOOBIX on May 25, 2024
    Please visit snoobix.com for more details
****************************************************** */


class Envelop_Design_Parts extends Controller
{
    public function __construct()
    {
        //if (!Auth::check()) return 'access_denied';
    }
   
    public function index()
    { 
        $data['module_title'] = 'Envelop Design Parts';
		$data['rows'] = envelop_design_parts_model::orderBy('id', 'desc')->get();
		return view("backend/envelop_design_parts_list", $data);
	
    }


    public function create()
    {
        $data['module_title'] = 'Envelop Design Parts';
       //$data['row'] = [];
       $data['submit_path'] = 'store';
       $data['module_name'] = 'Envelop Design Parts';
       return view("backend/envelop_design_parts_addedit", $data);       
    }

   
    public function store(Request $request)
    {
         $data['module_title'] = 'Envelop Design Parts';
        /* $request->validate([
            [[validateFieldsArray]]
        ]); */

        /* $record = [
			[[fieldsArray]]
		];
		$iscreated = envelop_design_parts_model::create($record); */

        $record = $request->all();
        if ($request->hasFile('thumbnail')) {
$imgFile = $request->file('thumbnail')->store('public');
$record['thumbnail'] = $imgFile;
}
if ($request->hasFile('front_image')) {
$imgFile = $request->file('front_image')->store('public');
$record['front_image'] = $imgFile;
}
if ($request->hasFile('back_image')) {
$imgFile = $request->file('back_image')->store('public');
$record['back_image'] = $imgFile;
}
if ($request->hasFile('flap_image')) {
$imgFile = $request->file('flap_image')->store('public');
$record['flap_image'] = $imgFile;
}

        
        $savedid = envelop_design_parts_model::create($record)->id;
		if($savedid){
			 //return view("backend/envelop_design_parts_addedit")->with('flash_success', "Record is saved successfuly");
             return redirect('backend/envelop_design_parts/create')->with('flash_success', "Record is saved successfuly");
		}else{
			$data['row'] = $request->all();
			return view("backend/envelop_design_parts_addedit", $data)->with('flash_failure', "Record is NOT saved successfuly");
		}
    }

    
    public function show()
    {
        //
    }

    
    public function edit($id)
    {
         $data['module_title'] = 'Envelop Design Parts';
        $data['submit_path'] = 'update';
        $recCond = [
			'id' => str2id($id)
		];
		$data['row'] = envelop_design_parts_model::where($recCond)->first();
		return view("backend/envelop_design_parts_addedit", $data);
    }

   
    public function update(Request $request)
    {
		 $data['module_title'] = 'Envelop Design Parts';
        $id = $request->post('id');
        $id = str2id($id);
        $venvelop_design_parts_model = envelop_design_parts_model::find($id);
        
         $record = $request->all();
         if ($request->hasFile('thumbnail')) {
$imgFile = $request->file('thumbnail')->store('public');
$record['thumbnail'] = $imgFile;
}
if ($request->hasFile('front_image')) {
$imgFile = $request->file('front_image')->store('public');
$record['front_image'] = $imgFile;
}
if ($request->hasFile('back_image')) {
$imgFile = $request->file('back_image')->store('public');
$record['back_image'] = $imgFile;
}
if ($request->hasFile('flap_image')) {
$imgFile = $request->file('flap_image')->store('public');
$record['flap_image'] = $imgFile;
}

        
        $isaved = $venvelop_design_parts_model->fill($record)->save();  //this will save record with all fillable items

        if($isaved){
			//return view("backend/envelop_design_parts_addedit")->with('flash_success', "Record is updated successfuly");
            return redirect('backend/envelop_design_parts')->with('flash_success', "Record is updated successfuly");
		}else{

			//$data['postData'] = $record;
             $data['submit_path'] = 'update';
             $recCond = [
                'id' => $id,
            ];
            $data['row'] = envelop_design_parts_model::where($recCond)->first();
			return view("backend/envelop_design_parts_addedit", $data)->with('flash_failure', "Record is NOT updated successfuly");
		}		
    }

   
    public function destroy(Request $request)
    {
        $id = $request->post('delid');
        $id = str2id($id);
        $venvelop_design_parts_model = envelop_design_parts_model::find($id);
        $isdeleted = $venvelop_design_parts_model->delete();
        if($isdeleted ){
            return redirect()->route('backend.envelop_design_parts')->with('flash_success','Record is deleted successfuly');
        }else{
            return redirect()->route('backend.envelop_design_parts')->with('flash_failure','Record is not deleted, try again later');
        }
    }
}
